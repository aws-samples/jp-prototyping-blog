"use strict";(self.webpackChunkjp_prototyping_blog=self.webpackChunkjp_prototyping_blog||[]).push([[4907],{3905:(t,a,e)=>{e.d(a,{Zo:()=>o,kt:()=>b});var n=e(7294);function l(t,a,e){return a in t?Object.defineProperty(t,a,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[a]=e,t}function r(t,a){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);a&&(n=n.filter((function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable}))),e.push.apply(e,n)}return e}function i(t){for(var a=1;a<arguments.length;a++){var e=null!=arguments[a]?arguments[a]:{};a%2?r(Object(e),!0).forEach((function(a){l(t,a,e[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):r(Object(e)).forEach((function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(e,a))}))}return t}function p(t,a){if(null==t)return{};var e,n,l=function(t,a){if(null==t)return{};var e,n,l={},r=Object.keys(t);for(n=0;n<r.length;n++)e=r[n],a.indexOf(e)>=0||(l[e]=t[e]);return l}(t,a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(n=0;n<r.length;n++)e=r[n],a.indexOf(e)>=0||Object.prototype.propertyIsEnumerable.call(t,e)&&(l[e]=t[e])}return l}var d=n.createContext({}),m=function(t){var a=n.useContext(d),e=a;return t&&(e="function"==typeof t?t(a):i(i({},a),t)),e},o=function(t){var a=m(t.components);return n.createElement(d.Provider,{value:a},t.children)},u="mdxType",k={inlineCode:"code",wrapper:function(t){var a=t.children;return n.createElement(n.Fragment,{},a)}},s=n.forwardRef((function(t,a){var e=t.components,l=t.mdxType,r=t.originalType,d=t.parentName,o=p(t,["components","mdxType","originalType","parentName"]),u=m(e),s=l,b=u["".concat(d,".").concat(s)]||u[s]||k[s]||r;return e?n.createElement(b,i(i({ref:a},o),{},{components:e})):n.createElement(b,i({ref:a},o))}));function b(t,a){var e=arguments,l=a&&a.mdxType;if("string"==typeof t||l){var r=e.length,i=new Array(r);i[0]=s;var p={};for(var d in a)hasOwnProperty.call(a,d)&&(p[d]=a[d]);p.originalType=t,p[u]="string"==typeof t?t:l,i[1]=p;for(var m=2;m<r;m++)i[m]=e[m];return n.createElement.apply(null,i)}return n.createElement.apply(null,e)}s.displayName="MDXCreateElement"},7002:(t,a,e)=>{e.r(a),e.d(a,{assets:()=>d,contentTitle:()=>i,default:()=>k,frontMatter:()=>r,metadata:()=>p,toc:()=>m});var n=e(7462),l=(e(7294),e(3905));const r={title:"Ruby on Rails \u3092 API Gateway + Lambda \u3067\u30b5\u30fc\u30d0\u30fc\u30ec\u30b9\u904b\u7528\u3059\u308b\u65b9\u6cd5",slug:"rails-lambda",tags:["lambda","api gateway","ruby on rails"],authors:["yukimine"]},i=void 0,p={permalink:"/blog/rails-lambda",editUrl:"https://github.com/aws-samples/jp-prototyping-blog/edit/main/blog/2022-12-21-rails-lambda/index.md",source:"@site/blog/2022-12-21-rails-lambda/index.md",title:"Ruby on Rails \u3092 API Gateway + Lambda \u3067\u30b5\u30fc\u30d0\u30fc\u30ec\u30b9\u904b\u7528\u3059\u308b\u65b9\u6cd5",description:"Ruby on Rails \u3067\u958b\u767a\u3055\u308c\u305f Web \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092 AWS \u3067\u7a3c\u50cd\u3055\u305b\u308b\u969b\u3001EC2 \u306e\u4eee\u60f3\u30b5\u30fc\u30d0\u30fc\u3084 ECS \u306e\u30b3\u30f3\u30c6\u30ca\u74b0\u5883\u3067\u5b9f\u884c\u3057\u3066 ALB \u7b49\u306e\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u30fc\u3067\u516c\u958b\u3059\u308b\u306e\u304c\u4e00\u822c\u7684\u3067\u3059\u3002\u3053\u306e\u65b9\u6cd5\u306f\u7a3c\u50cd\u6642\u9593\u306b\u6bd4\u4f8b\u3057\u305f\u6599\u91d1\u3068\u306a\u308a\u307e\u3059\u304c\u3001\u3082\u30461\u3064\u306e\u9078\u629e\u80a2\u3068\u3057\u3066\u3001\u6642\u9593\u3067\u306f\u306a\u304f\u30ea\u30af\u30a8\u30b9\u30c8\u56de\u6570\u306b\u5fdc\u3058\u305f\u6599\u91d1\u3068\u306a\u308b API Gateway \u3068 Lambda \u3092\u4f7f\u3046\u65b9\u6cd5\u304c\u3042\u308a\u307e\u3059\u3002\u4eca\u56de\u306f\u3001Ruby on Rails \u3092 AWS Lambda \u3067\u52d5\u304b\u3059\u65b9\u6cd5\u3092\u89e3\u8aac\u3057\u307e\u3059\u3002",date:"2022-12-21T00:00:00.000Z",formattedDate:"2022\u5e7412\u670821\u65e5",tags:[{label:"lambda",permalink:"/blog/tags/lambda"},{label:"api gateway",permalink:"/blog/tags/api-gateway"},{label:"ruby on rails",permalink:"/blog/tags/ruby-on-rails"}],readingTime:13.69,hasTruncateMarker:!0,authors:[{name:"Yukinobu Mine",title:"Prototyping Engineer",url:"https://github.com/Yukinobu-Mine",imageURL:"https://github.com/Yukinobu-Mine.png",key:"yukimine"}],frontMatter:{title:"Ruby on Rails \u3092 API Gateway + Lambda \u3067\u30b5\u30fc\u30d0\u30fc\u30ec\u30b9\u904b\u7528\u3059\u308b\u65b9\u6cd5",slug:"rails-lambda",tags:["lambda","api gateway","ruby on rails"],authors:["yukimine"]},prevItem:{title:"Fluentd \u304b\u3089 Kinesis Data Streams \u3078\u30b5\u30a4\u30ba\u304c\u5927\u304d\u3044\u30c7\u30fc\u30bf\u3092\u8ee2\u9001\u3059\u308b",permalink:"/blog/fluentd-kds"},nextItem:{title:"\u65b0\u898f AWS \u30a2\u30ab\u30a6\u30f3\u30c8\u3067 CodeBuild \u3092\u5229\u7528\u3059\u308b\u969b\u306e\u6ce8\u610f\u70b9",permalink:"/blog/codebuild-concurrency"}},d={authorsImageUrls:[void 0]},m=[{value:"Ruby on Rails \u3068\u306f",id:"ruby-on-rails-\u3068\u306f",level:2},{value:"Ruby on Rails \u306b\u3088\u308b REST API \u306e\u5b9f\u88c5",id:"ruby-on-rails-\u306b\u3088\u308b-rest-api-\u306e\u5b9f\u88c5",level:2},{value:"\u30b5\u30f3\u30d7\u30eb Web \u30a2\u30d7\u30ea\u306e\u30e2\u30c7\u30eb\u5b9a\u7fa9",id:"\u30b5\u30f3\u30d7\u30eb-web-\u30a2\u30d7\u30ea\u306e\u30e2\u30c7\u30eb\u5b9a\u7fa9",level:3},{value:"\u30b5\u30f3\u30d7\u30eb Web \u30a2\u30d7\u30ea\u306e\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u30fc\u5b9a\u7fa9",id:"\u30b5\u30f3\u30d7\u30eb-web-\u30a2\u30d7\u30ea\u306e\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u30fc\u5b9a\u7fa9",level:3},{value:"\u30b5\u30f3\u30d7\u30eb Web \u30a2\u30d7\u30ea\u306e\u52d5\u4f5c\u78ba\u8a8d",id:"\u30b5\u30f3\u30d7\u30eb-web-\u30a2\u30d7\u30ea\u306e\u52d5\u4f5c\u78ba\u8a8d",level:3},{value:"Ruby on Rails \u3068 Web \u30b5\u30fc\u30d0\u30fc\u306e\u95a2\u4fc2",id:"ruby-on-rails-\u3068-web-\u30b5\u30fc\u30d0\u30fc\u306e\u95a2\u4fc2",level:2},{value:"AWS \u3067 Ruby on Rails \u3092\u52d5\u304b\u3059\u65b9\u6cd5",id:"aws-\u3067-ruby-on-rails-\u3092\u52d5\u304b\u3059\u65b9\u6cd5",level:2},{value:"ALB + EC2 / ECS",id:"alb--ec2--ecs",level:3},{value:"API Gateway + Lambda",id:"api-gateway--lambda",level:3},{value:"Ruby on Rails \u3092 Lambda \u95a2\u6570\u5316\u3059\u308b",id:"ruby-on-rails-\u3092-lambda-\u95a2\u6570\u5316\u3059\u308b",level:2},{value:"\u74b0\u5883\u5909\u6570\u306e\u8a2d\u5b9a",id:"\u74b0\u5883\u5909\u6570\u306e\u8a2d\u5b9a",level:3},{value:"\u30cf\u30f3\u30c9\u30e9\u30fc\u95a2\u6570\u306e\u5b9f\u88c5",id:"\u30cf\u30f3\u30c9\u30e9\u30fc\u95a2\u6570\u306e\u5b9f\u88c5",level:3},{value:"rack \u306e\u5165\u51fa\u529b\u4ed5\u69d8\u3068\u306e\u76f8\u4e92\u5909\u63db",id:"rack-\u306e\u5165\u51fa\u529b\u4ed5\u69d8\u3068\u306e\u76f8\u4e92\u5909\u63db",level:4},{value:"\u30ea\u30af\u30a8\u30b9\u30c8\u5bfe\u5fdc\u8868",id:"\u30ea\u30af\u30a8\u30b9\u30c8\u5bfe\u5fdc\u8868",level:4},{value:"\u30ec\u30b9\u30dd\u30f3\u30b9\u5bfe\u5fdc\u8868",id:"\u30ec\u30b9\u30dd\u30f3\u30b9\u5bfe\u5fdc\u8868",level:4},{value:"\u30b5\u30f3\u30d7\u30eb\u3092 AWS \u3067\u52d5\u304b\u3057\u3066\u307f\u308b",id:"\u30b5\u30f3\u30d7\u30eb\u3092-aws-\u3067\u52d5\u304b\u3057\u3066\u307f\u308b",level:3},{value:"\u307e\u3068\u3081",id:"\u307e\u3068\u3081",level:2}],o={toc:m},u="wrapper";function k(t){let{components:a,...r}=t;return(0,l.kt)(u,(0,n.Z)({},o,r,{components:a,mdxType:"MDXLayout"}),(0,l.kt)("p",null,"Ruby on Rails \u3067\u958b\u767a\u3055\u308c\u305f Web \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092 AWS \u3067\u7a3c\u50cd\u3055\u305b\u308b\u969b\u3001",(0,l.kt)("a",{parentName:"p",href:"https://aws.amazon.com/ec2/"},"EC2")," \u306e\u4eee\u60f3\u30b5\u30fc\u30d0\u30fc\u3084 ",(0,l.kt)("a",{parentName:"p",href:"https://aws.amazon.com/ecs/"},"ECS")," \u306e\u30b3\u30f3\u30c6\u30ca\u74b0\u5883\u3067\u5b9f\u884c\u3057\u3066 ",(0,l.kt)("a",{parentName:"p",href:"https://aws.amazon.com/elasticloadbalancing/application-load-balancer/"},"ALB")," \u7b49\u306e\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u30fc\u3067\u516c\u958b\u3059\u308b\u306e\u304c\u4e00\u822c\u7684\u3067\u3059\u3002\u3053\u306e\u65b9\u6cd5\u306f\u7a3c\u50cd\u6642\u9593\u306b\u6bd4\u4f8b\u3057\u305f\u6599\u91d1\u3068\u306a\u308a\u307e\u3059\u304c\u3001\u3082\u30461\u3064\u306e\u9078\u629e\u80a2\u3068\u3057\u3066\u3001\u6642\u9593\u3067\u306f\u306a\u304f\u30ea\u30af\u30a8\u30b9\u30c8\u56de\u6570\u306b\u5fdc\u3058\u305f\u6599\u91d1\u3068\u306a\u308b ",(0,l.kt)("a",{parentName:"p",href:"https://aws.amazon.com/api-gateway/"},"API Gateway")," \u3068 ",(0,l.kt)("a",{parentName:"p",href:"https://aws.amazon.com/jp/lambda/"},"Lambda")," \u3092\u4f7f\u3046\u65b9\u6cd5\u304c\u3042\u308a\u307e\u3059\u3002\u4eca\u56de\u306f\u3001Ruby on Rails \u3092 AWS Lambda \u3067\u52d5\u304b\u3059\u65b9\u6cd5\u3092\u89e3\u8aac\u3057\u307e\u3059\u3002"),(0,l.kt)("h2",{id:"ruby-on-rails-\u3068\u306f"},"Ruby on Rails \u3068\u306f"),(0,l.kt)("p",null,"Ruby on Rails \u306f\u3001Ruby \u8a00\u8a9e\u3067 Web \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u958b\u767a\u3059\u308b\u305f\u3081\u306e\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u306e1\u3064\u3067\u3059\u3002\u300c\u8a2d\u5b9a\u3088\u308a\u898f\u7d04 (Convention over Configuration, CoC)\u300d\u3068\u3044\u3046\u30d1\u30e9\u30c0\u30a4\u30e0\u306e\u5148\u99c6\u8005\u3068\u3057\u3066\u6709\u540d\u3067\u3001\u4ed6\u306e\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u306b\u3082\u5927\u304d\u306a\u5f71\u97ff\u3092\u53ca\u307c\u3057\u307e\u3057\u305f\u3002"),(0,l.kt)("p",null,"rails \u30b3\u30de\u30f3\u30c9\u306b\u3088\u308b\u30b3\u30fc\u30c9\u306e\u81ea\u52d5\u751f\u6210\u6a5f\u80fd\u304c\u5145\u5b9f\u3057\u3066\u304a\u308a\u3001\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u4f5c\u6210\u3060\u3051\u3067\u306a\u304f\u3001\u30e2\u30c7\u30eb\u3084\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u30fc\u306e\u751f\u6210\u3084\u8a8d\u8a3c\u6a5f\u80fd\u306e\u8ffd\u52a0\u3068\u3044\u3063\u305f\u4e8b\u307e\u3067\u884c\u3046\u4e8b\u304c\u3067\u304d\u307e\u3059\u3002\u7279\u306b Active Record \u306b\u3088\u308b\u30e2\u30c7\u30eb\u3068\u30c6\u30fc\u30d6\u30eb\u5b9a\u7fa9\u306e\u81ea\u52d5\u751f\u6210\u306f\u4fbf\u5229\u3067\u3001Web \u30a2\u30d7\u30ea\u958b\u767a\u3067\u5fc5\u9808\u3068\u306a\u308b\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u30a2\u30af\u30bb\u30b9\u3092\u7c21\u5358\u306b\u5b9f\u88c5\u3067\u304d\u307e\u3059\u3002"),(0,l.kt)("p",null,"\u4eca\u56de\u306f\u3001\u5148\u65e5 aws-samples \u3068\u3057\u3066\u516c\u958b\u3055\u308c\u305f ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/aws-samples/rails-lambda-handler"},"AWS Lambda handler sample for Ruby on Rails")," \u3092\u5143\u306b\u3001Ruby on Rails \u3067\u5b9f\u88c5\u3055\u308c\u305f Web \u30a2\u30d7\u30ea\u3092 AWS Lambda \u3067\u5b9f\u884c\u3057\u3001Amazon API Gateway \u3067\u516c\u958b\u3059\u308b\u65b9\u6cd5\u3068\u305d\u306e\u4ed5\u7d44\u307f\u306b\u3064\u3044\u3066\u89e3\u8aac\u3057\u307e\u3059\u3002"),(0,l.kt)("h2",{id:"ruby-on-rails-\u306b\u3088\u308b-rest-api-\u306e\u5b9f\u88c5"},"Ruby on Rails \u306b\u3088\u308b REST API \u306e\u5b9f\u88c5"),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"https://github.com/aws-samples/rails-lambda-handler"},"AWS Lambda handler sample for Ruby on Rails")," \u3067\u306f\u3001Ruby on Rails \u3067\u5b9f\u88c5\u3057\u305f Web \u30a2\u30d7\u30ea\u306e\u30b5\u30f3\u30d7\u30eb\u3092\u63d0\u4f9b\u3057\u3066\u3044\u307e\u3059\u3002\u3053\u306e Web \u30a2\u30d7\u30ea\u306f\u3001Ruby on Rails \u306e ",(0,l.kt)("a",{parentName:"p",href:"https://railsguides.jp/api_app.html"},"API \u30e2\u30fc\u30c9")," \u3092\u5229\u7528\u3057\u3066\u5b9f\u88c5\u3057\u305f\u30b7\u30f3\u30d7\u30eb\u306a Web API \u3067\u3001\u300cHello, World!\u300d\u3068\u3044\u3046\u56fa\u5b9a\u30c7\u30fc\u30bf\u306e\u307f\u3092\u6301\u3064 SQLite \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u5bfe\u3057\u3066\u30af\u30a8\u30ea\u30fc\u3092\u884c\u3046\u4e8b\u304c\u3067\u304d\u307e\u3059\u3002"),(0,l.kt)("p",null,"\u307e\u305a\u306f\u3001\u3053\u306e\u30b5\u30f3\u30d7\u30eb\u30a2\u30d7\u30ea\u306b\u3064\u3044\u3066\u7c21\u5358\u306b\u89e3\u8aac\u3057\u307e\u3059\u3002"),(0,l.kt)("h3",{id:"\u30b5\u30f3\u30d7\u30eb-web-\u30a2\u30d7\u30ea\u306e\u30e2\u30c7\u30eb\u5b9a\u7fa9"},"\u30b5\u30f3\u30d7\u30eb Web \u30a2\u30d7\u30ea\u306e\u30e2\u30c7\u30eb\u5b9a\u7fa9"),(0,l.kt)("p",null,"\u30e2\u30c7\u30eb\u306f\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3067\u751f\u6210\u3057\u3001\u30c6\u30fc\u30d6\u30eb\u3092\u81ea\u52d5\u751f\u6210\u3057\u3066\u3044\u307e\u3059\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"rails generate model Message text:string\n")),(0,l.kt)("p",null,"\u3053\u308c\u306b\u3088\u3063\u3066\u751f\u6210\u3055\u308c\u305f\u30c6\u30fc\u30d6\u30eb\u300c",(0,l.kt)("inlineCode",{parentName:"p"},"messages"),"\u300d\u306e\u5b9a\u7fa9\u306f\u4ee5\u4e0b\u306e\u901a\u308a\u3067\u3059\u3002"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"\u30ab\u30e9\u30e0\u540d"),(0,l.kt)("th",{parentName:"tr",align:null},"\u578b"),(0,l.kt)("th",{parentName:"tr",align:null},"\u610f\u5473"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"id")),(0,l.kt)("td",{parentName:"tr",align:null},"integer"),(0,l.kt)("td",{parentName:"tr",align:null},"\u30e1\u30c3\u30bb\u30fc\u30b8 ID")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"text")),(0,l.kt)("td",{parentName:"tr",align:null},"varchar"),(0,l.kt)("td",{parentName:"tr",align:null},"\u30e1\u30c3\u30bb\u30fc\u30b8")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"created_at")),(0,l.kt)("td",{parentName:"tr",align:null},"datetime"),(0,l.kt)("td",{parentName:"tr",align:null},"\u4f5c\u6210\u65e5\u6642")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"updated_at")),(0,l.kt)("td",{parentName:"tr",align:null},"datetime"),(0,l.kt)("td",{parentName:"tr",align:null},"\u66f4\u65b0\u65e5\u6642")))),(0,l.kt)("p",null,"\u56fa\u5b9a\u306e SQLite \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb\u306b\u306f\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30c7\u30fc\u30bf\u3092\u683c\u7d0d\u3057\u3066\u3044\u307e\u3059\u3002"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"id"),(0,l.kt)("th",{parentName:"tr",align:null},"text"),(0,l.kt)("th",{parentName:"tr",align:null},"created_at"),(0,l.kt)("th",{parentName:"tr",align:null},"updated_at"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"1"),(0,l.kt)("td",{parentName:"tr",align:null},"Hello, World!"),(0,l.kt)("td",{parentName:"tr",align:null},"2022-12-15 01:31:59.291570"),(0,l.kt)("td",{parentName:"tr",align:null},"2022-12-15 01:31:59.291570")))),(0,l.kt)("h3",{id:"\u30b5\u30f3\u30d7\u30eb-web-\u30a2\u30d7\u30ea\u306e\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u30fc\u5b9a\u7fa9"},"\u30b5\u30f3\u30d7\u30eb Web \u30a2\u30d7\u30ea\u306e\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u30fc\u5b9a\u7fa9"),(0,l.kt)("p",null,"\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u30fc\u306f\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3067\u751f\u6210\u3057\u3066\u3044\u307e\u3059\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"rails generate controller Messages\n")),(0,l.kt)("p",null,"\u751f\u6210\u3055\u308c\u305f\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u30fc\u300c",(0,l.kt)("a",{parentName:"p",href:"https://github.com/aws-samples/rails-lambda-handler/blob/main/rails/app/controllers/messages_controller.rb"},(0,l.kt)("inlineCode",{parentName:"a"},"MessagesController")),"\u300d\u306b\u306f\u3001\u4ee5\u4e0b\u306e\u30a2\u30af\u30b7\u30e7\u30f3\u3092\u5b9f\u88c5\u3057\u3066\u3044\u307e\u3059\u3002"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"\u540d\u524d"),(0,l.kt)("th",{parentName:"tr",align:null},"\u30eb\u30fc\u30c8"),(0,l.kt)("th",{parentName:"tr",align:null},"\u52d5\u4f5c"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"index")),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"GET")," /messages"),(0,l.kt)("td",{parentName:"tr",align:null},"\u30e1\u30c3\u30bb\u30fc\u30b8\u4e00\u89a7\u3092\u8fd4\u3059")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"show")),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"GET")," /messages/",(0,l.kt)("inlineCode",{parentName:"td"},"{id}")),(0,l.kt)("td",{parentName:"tr",align:null},"\u6307\u5b9a\u3055\u308c\u305f ID \u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u8fd4\u3059")))),(0,l.kt)("p",null,"\u30e1\u30c3\u30bb\u30fc\u30b8\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306a JSON \u30c7\u30fc\u30bf\u3068\u3057\u3066\u8fd4\u3057\u3066\u3044\u307e\u3059\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'{\n    "id": 1,\n    "text": "Hello, World!",\n    "created_at" :"2022-12-15T01:31:59.291Z",\n    "updated_at": "2022-12-15T01:31:59.291Z",\n    "url": "\u30e1\u30c3\u30bb\u30fc\u30b8\u306e URL"\n}\n')),(0,l.kt)("h3",{id:"\u30b5\u30f3\u30d7\u30eb-web-\u30a2\u30d7\u30ea\u306e\u52d5\u4f5c\u78ba\u8a8d"},"\u30b5\u30f3\u30d7\u30eb Web \u30a2\u30d7\u30ea\u306e\u52d5\u4f5c\u78ba\u8a8d"),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"https://github.com/aws-samples/rails-lambda-handler"},"AWS Lambda handler sample for Ruby on Rails")," \u3092\u30ed\u30fc\u30ab\u30eb\u306b clone \u3057\u3001",(0,l.kt)("inlineCode",{parentName:"p"},"rails")," \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3067\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3059\u308b\u4e8b\u306b\u3088\u308a\u3001\u30ed\u30fc\u30ab\u30eb\u74b0\u5883\u3067\u52d5\u4f5c\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"rails server\n")),(0,l.kt)("p",null,"cURL \u7b49\u306e\u30c4\u30fc\u30eb\u3067 ",(0,l.kt)("inlineCode",{parentName:"p"},"http://localhost:3000/messages")," \u306b GET \u30ea\u30af\u30a8\u30b9\u30c8\u3092\u884c\u3046\u3068\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30ec\u30b9\u30dd\u30f3\u30b9\u304c\u8fd4\u3055\u308c\u307e\u3059\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'curl http://localhost:3000/messages\n\n[{"id":1,"text":"Hello, World!","created_at":"2022-12-15T01:31:59.291Z","updated_at":"2022-12-15T01:31:59.291Z","url":"http://localhost:3000/messages/1"}]\n')),(0,l.kt)("h2",{id:"ruby-on-rails-\u3068-web-\u30b5\u30fc\u30d0\u30fc\u306e\u95a2\u4fc2"},"Ruby on Rails \u3068 Web \u30b5\u30fc\u30d0\u30fc\u306e\u95a2\u4fc2"),(0,l.kt)("p",null,"Ruby on Rails \u306b\u304a\u3044\u3066\u3001Web \u30b5\u30fc\u30d0\u30fc\u3078\u306e\u30ea\u30af\u30a8\u30b9\u30c8\u304c Web \u30a2\u30d7\u30ea\u3067\u51e6\u7406\u3055\u308c\u3001\u7d50\u679c\u304c\u30ec\u30b9\u30dd\u30f3\u30b9\u3068\u3057\u3066\u8fd4\u3055\u308c\u308b\u307e\u3067\u306e\u6d41\u308c\u3092\u7c21\u5358\u306b\u89e3\u8aac\u3057\u307e\u3059\u3002"),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"Ruby on Rails \u3068 Web \u30b5\u30fc\u30d0\u30fc\u306e\u95a2\u4fc2",src:e(912).Z,width:"1280",height:"720"})),(0,l.kt)("p",null,"Ruby \u8a00\u8a9e\u3067\u306f\u3001Web \u30a2\u30d7\u30ea\u3068\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u30b5\u30fc\u30d0\u30fc\u3068\u306e\u9593\u306e\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30a4\u30b9\u4ed5\u69d8\u3068\u3057\u3066 ",(0,l.kt)("a",{parentName:"p",href:"https://rack.github.io/"},"rack")," \u304c\u5e83\u304f\u63a1\u7528\u3055\u308c\u3066\u3044\u307e\u3059\u3002Ruby on Rails \u306f\u3053\u306e rack \u306b\u6e96\u62e0\u3057\u3066\u304a\u308a\u3001\u6a19\u6e96\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u30b5\u30fc\u30d0\u30fc\u3068\u3057\u3066 ",(0,l.kt)("a",{parentName:"p",href:"https://puma.io/"},"puma")," \u304c\u63a1\u7528\u3055\u308c\u3066\u3044\u307e\u3059\u3002puma \u306f\u3001Web \u30b5\u30fc\u30d0\u30fc\u304c\u53d7\u3051\u53d6\u3063\u305f HTTP \u30ea\u30af\u30a8\u30b9\u30c8\u3092 rack \u4ed5\u69d8\u306b\u57fa\u3065\u3044\u3066 Web \u30a2\u30d7\u30ea\u306b\u4f1d\u3048\u3001Web \u30a2\u30d7\u30ea\u304c rack \u4ed5\u69d8\u306b\u57fa\u3065\u3044\u3066\u751f\u6210\u3057\u305f\u30ec\u30b9\u30dd\u30f3\u30b9\u3092 HTTP \u30ec\u30b9\u30dd\u30f3\u30b9\u3068\u3057\u3066 Web \u30b5\u30fc\u30d0\u30fc\u306b\u8fd4\u3057\u307e\u3059\u3002"),(0,l.kt)("p",null,"puma \u306f\u3001\u5358\u4f53\u3067\u3082 Web \u30b5\u30fc\u30d0\u30fc\u3068\u3057\u3066\u52d5\u4f5c\u3055\u305b\u308b\u4e8b\u304c\u53ef\u80fd\u3067\u306f\u3042\u308a\u307e\u3059\u304c\u3001Web \u30b5\u30fc\u30d0\u30fc\u6a5f\u80fd\u304c\u4f7f\u308f\u308c\u308b\u306e\u306f\u30c6\u30b9\u30c8\u7528\u9014\u304c\u591a\u304f\u3001\u672c\u756a\u74b0\u5883\u3067\u306f\u3088\u308a\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u3084\u30b9\u30b1\u30fc\u30e9\u30d3\u30ea\u30c6\u30a3\u306b\u512a\u308c\u305f ",(0,l.kt)("a",{parentName:"p",href:"https://nginx.org/"},"nginx")," \u7b49\u3092\u5229\u7528\u3059\u308b\u306e\u304c\u4e00\u822c\u7684\u3068\u306a\u3063\u3066\u3044\u307e\u3059\u3002(\u524d\u7bc0\u3067 ",(0,l.kt)("inlineCode",{parentName:"p"},"rails server")," \u3092\u5b9f\u884c\u3057\u305f\u969b\u306f\u3001puma \u3092 Web \u30b5\u30fc\u30d0\u30fc\u3068\u3057\u3066\u3082\u5229\u7528\u3057\u305f\u5f62\u3068\u306a\u308a\u307e\u3059)"),(0,l.kt)("h2",{id:"aws-\u3067-ruby-on-rails-\u3092\u52d5\u304b\u3059\u65b9\u6cd5"},"AWS \u3067 Ruby on Rails \u3092\u52d5\u304b\u3059\u65b9\u6cd5"),(0,l.kt)("p",null,"Ruby on Rails \u3067\u5b9f\u88c5\u3055\u308c\u305f Web \u30a2\u30d7\u30ea\u3092 AWS \u3067\u7a3c\u50cd\u3055\u305b\u308b\u65b9\u6cd5\u306f\u3044\u304f\u3064\u304b\u3042\u308a\u307e\u3059\u304c\u3001\u4eca\u56de\u306f\u4ee3\u8868\u7684\u306a2\u30d1\u30bf\u30fc\u30f3\u3092\u7d39\u4ecb\u3057\u307e\u3059\u3002"),(0,l.kt)("h3",{id:"alb--ec2--ecs"},"ALB + EC2 / ECS"),(0,l.kt)("p",null,"\u6700\u3082\u4e00\u822c\u7684\u306a\u306e\u306f\u3001nginx \u3084 Ruby on Rails \u30a2\u30d7\u30ea\u3092 Amazon EC2 \u4eee\u60f3\u30de\u30b7\u30f3\u306b\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3057\u305f\u308a\u3001Amazon ECS \u3067 Docker \u30b3\u30f3\u30c6\u30ca\u5316\u3068\u3057\u3066\u5b9f\u884c\u3057\u3001Application Load Balancer \u7b49\u306e\u30ed\u30fc\u30c9\u30d0\u30e9\u30f3\u30b5\u30fc\u3067\u516c\u958b\u3059\u308b\u65b9\u6cd5\u3067\u3059\u3002"),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"ALB + ECS \u306e\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3\u4f8b",src:e(8997).Z,width:"1280",height:"720"})),(0,l.kt)("p",null,"\u3053\u306e\u65b9\u6cd5\u306f\u3001Ruby on Rails \u306e\u6a19\u6e96\u7684\u306a\u69cb\u6210\u3092\u307b\u307c\u305d\u306e\u307e\u307e\u30af\u30e9\u30a6\u30c9\u306b\u79fb\u884c\u3067\u304d\u308b\u30e1\u30ea\u30c3\u30c8\u304c\u3042\u308a\u307e\u3059\u3002\u6599\u91d1\u306f\u7a3c\u50cd\u6642\u9593\u306b\u6bd4\u4f8b\u3059\u308b\u305f\u3081\u3001\u5e38\u306b\u4e00\u5b9a\u4ee5\u4e0a\u306e\u7a3c\u50cd\u7387\u304c\u3042\u308b\u30b5\u30fc\u30d3\u30b9\u306b\u5411\u3044\u305f\u65b9\u6cd5\u306b\u306a\u308a\u307e\u3059\u3002"),(0,l.kt)("h3",{id:"api-gateway--lambda"},"API Gateway + Lambda"),(0,l.kt)("p",null,"\u305d\u3057\u3066\u3082\u30461\u3064\u306e\u65b9\u6cd5\u304c\u3001AWS Lambda \u3067 Ruby on Rails \u30a2\u30d7\u30ea\u3092\u5b9f\u884c\u3057\u3001Amazon API Gateway \u306e Lambda \u30d7\u30ed\u30ad\u30b7\u7d71\u5408\u3067\u516c\u958b\u3059\u308b\u65b9\u6cd5\u3067\u3059\u3002\u6599\u91d1\u306f\u30ea\u30af\u30a8\u30b9\u30c8\u6570\u306b\u6bd4\u4f8b\u3059\u308b\u305f\u3081\u3001\u7a3c\u50cd\u304c\u7279\u5b9a\u306e\u6642\u9593\u5e2f\u306b\u96c6\u4e2d\u3059\u308b\u3088\u3046\u306a\u30b5\u30fc\u30d3\u30b9\u306b\u5411\u3044\u305f\u65b9\u6cd5\u306b\u306a\u308a\u307e\u3059\u3002"),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"API Gateway + Lambda \u306e\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3\u4f8b",src:e(6297).Z,width:"1280",height:"720"})),(0,l.kt)("p",null,"AWS Lambda \u3067 Ruby on Rails \u3092\u5b9f\u884c\u3059\u308b\u306b\u306f\u3001Lambda \u95a2\u6570\u306e\u5b9f\u884c\u74b0\u5883\u306e\u5236\u7d04\u306b\u5408\u308f\u305b\u3066\u3044\u304f\u3064\u304b\u306e\u8a2d\u5b9a\u5909\u66f4\u304c\u5fc5\u8981\u3068\u306a\u308a\u307e\u3059\u3002\u307e\u305f\u3001API Gateway \u304b\u3089\u306f HTTP \u30ea\u30af\u30a8\u30b9\u30c8\u304c Lambda \u95a2\u6570\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u30fc\u3068\u3057\u3066\u6e21\u3055\u308c\u3001Lambda \u95a2\u6570\u306e\u623b\u308a\u5024\u304b\u3089 HTTP \u30ec\u30b9\u30dd\u30f3\u30b9\u304c\u751f\u6210\u3055\u308c\u308b\u305f\u3081\u3001\u305d\u308c\u3089\u3092 Ruby on Rails \u304c\u7406\u89e3\u3067\u304d\u308b rack \u4ed5\u69d8\u306b\u5909\u63db\u3059\u308b\u51e6\u7406\u3082\u5fc5\u8981\u3068\u306a\u308a\u307e\u3059\u3002"),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"Ruby on Rails \u3068 API Gateway / Lambda \u306e\u95a2\u4fc2",src:e(7272).Z,width:"1280",height:"720"})),(0,l.kt)("h2",{id:"ruby-on-rails-\u3092-lambda-\u95a2\u6570\u5316\u3059\u308b"},"Ruby on Rails \u3092 Lambda \u95a2\u6570\u5316\u3059\u308b"),(0,l.kt)("p",null,"Ruby on Rails \u30a2\u30d7\u30ea\u3092 Lambda \u95a2\u6570\u5316\u3059\u308b\u65b9\u6cd5\u306b\u306f\u4ee5\u4e0b\u306e2\u7a2e\u985e\u304c\u5b58\u5728\u3057\u307e\u3059\u3002"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://docs.aws.amazon.com/lambda/latest/dg/lambda-ruby.html"},"AWS Lambda \u306e Ruby \u30e9\u30f3\u30bf\u30a4\u30e0\u3092\u5229\u7528\u3059\u308b")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://docs.aws.amazon.com/lambda/latest/dg/ruby-image.html"},"\u30b3\u30f3\u30c6\u30ca\u30a4\u30e1\u30fc\u30b8\u3092\u4f5c\u6210\u3059\u308b"))),(0,l.kt)("p",null,"2022\u5e7412\u6708\u73fe\u5728\u3001AWS Lambda \u306e Ruby \u30e9\u30f3\u30bf\u30a4\u30e0\u304c\u5bfe\u5fdc\u3057\u3066\u3044\u308b Ruby \u8a00\u8a9e\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u306f 2.7 \u306e\u307f\u306e\u305f\u3081\u3001Ruby 3.0 \u4ee5\u964d\u3092\u5229\u7528\u3057\u305f\u3044\u5834\u5408\u306f\u72ec\u81ea\u306e\u30b3\u30f3\u30c6\u30ca\u30a4\u30e1\u30fc\u30b8\u3092\u4f5c\u6210\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002"),(0,l.kt)("p",null,"\u672c\u8a18\u4e8b\u3067\u306f\u305d\u308c\u305e\u308c\u306e\u65b9\u6cd5\u306e\u8a73\u7d30\u306f\u5272\u611b\u3057\u307e\u3059\u304c\u3001",(0,l.kt)("a",{parentName:"p",href:"https://github.com/aws-samples/rails-lambda-handler/blob/main/rails/Dockerfile"},"Dockerfile \u306e\u30b5\u30f3\u30d7\u30eb"),"\u3092\u63d0\u4f9b\u3057\u3066\u3044\u307e\u3059\u306e\u3067\u3001\u72ec\u81ea\u306e\u30b3\u30f3\u30c6\u30ca\u30a4\u30e1\u30fc\u30b8\u3092\u4f5c\u6210\u3059\u308b\u969b\u306f\u53c2\u8003\u306b\u3057\u3066\u307f\u3066\u4e0b\u3055\u3044\u3002"),(0,l.kt)("h3",{id:"\u74b0\u5883\u5909\u6570\u306e\u8a2d\u5b9a"},"\u74b0\u5883\u5909\u6570\u306e\u8a2d\u5b9a"),(0,l.kt)("p",null,"Lambda \u95a2\u6570\u3092\u4f5c\u6210\u3057\u305f\u3089\u3001\u74b0\u5883\u5909\u6570\u3092\u8a2d\u5b9a\u3057\u307e\u3059\u3002Ruby on Rails \u306e\u4e00\u822c\u7684\u306a\u74b0\u5883\u5909\u6570\u306b\u52a0\u3048\u3066\u3001Lambda \u95a2\u6570\u306e\u5b9f\u884c\u74b0\u5883\u3067\u306f ",(0,l.kt)("inlineCode",{parentName:"p"},"/tmp")," \u4ee5\u5916\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u66f8\u304d\u8fbc\u3080\u4e8b\u304c\u3067\u304d\u306a\u3044\u3068\u3044\u3046\u5236\u9650\u306b\u5bfe\u5fdc\u3059\u308b\u305f\u3081\u306e\u4ee5\u4e0b\u306e\u8a2d\u5b9a\u304c\u5fc5\u8981\u3068\u306a\u308a\u307e\u3059\u3002"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"\u74b0\u5883\u5909\u6570"),(0,l.kt)("th",{parentName:"tr",align:null},"\u8a2d\u5b9a\u4f8b"),(0,l.kt)("th",{parentName:"tr",align:null},"\u76ee\u7684"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"BOOTSNAP_CACHE_DIR")),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"/tmp/cache")),(0,l.kt)("td",{parentName:"tr",align:null},"Rails \u30a2\u30d7\u30ea\u306e\u8d77\u52d5\u9ad8\u901f\u5316\u306e\u305f\u3081\u306e\u30ad\u30e3\u30c3\u30b7\u30e5\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092 ",(0,l.kt)("inlineCode",{parentName:"td"},"/tmp")," \u4ee5\u4e0b\u306b\u5909\u66f4\u3059\u308b")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"RAILS_LOG_TO_STDOUT")),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"1")),(0,l.kt)("td",{parentName:"tr",align:null},"\u30ed\u30b0\u3092\u30d5\u30a1\u30a4\u30eb\u3067\u306f\u306a\u304f\u6a19\u6e96\u51fa\u529b\u306b\u51fa\u529b\u3057\u3001CloudWatch Logs \u3067\u95b2\u89a7\u53ef\u80fd\u306b\u3059\u308b")))),(0,l.kt)("h3",{id:"\u30cf\u30f3\u30c9\u30e9\u30fc\u95a2\u6570\u306e\u5b9f\u88c5"},"\u30cf\u30f3\u30c9\u30e9\u30fc\u95a2\u6570\u306e\u5b9f\u88c5"),(0,l.kt)("p",null,"Lambda \u95a2\u6570\u306e\u30a8\u30f3\u30c8\u30ea\u30fc\u30dd\u30a4\u30f3\u30c8\u3068\u306a\u308b\u306e\u304c\u30cf\u30f3\u30c9\u30e9\u30fc\u95a2\u6570\u3067\u3059\u3002API Gateway \u304b\u3089\u306e\u30ea\u30af\u30a8\u30b9\u30c8\u3068\u30ec\u30b9\u30dd\u30f3\u30b9\u3092 rack \u4ed5\u69d8\u306b\u5909\u63db\u3057\u3066 Ruby on Rails \u30a2\u30d7\u30ea\u3092\u5b9f\u884c\u3059\u308b\u51e6\u7406\u306f\u3001\u30cf\u30f3\u30c9\u30e9\u30fc\u95a2\u6570\u3067\u884c\u3046\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002"),(0,l.kt)("p",null,"Amazon API Gateway \u306b\u306f REST API \u3068 HTTP API \u304c\u3042\u308a\u3001\u305d\u308c\u305e\u308c\u30ea\u30af\u30a8\u30b9\u30c8\u3068\u30ec\u30b9\u30dd\u30f3\u30b9\u3092 Lambda \u95a2\u6570\u3068\u3084\u308a\u53d6\u308a\u3059\u308b\u305f\u3081\u306e\u5165\u51fa\u529b\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u304c\u7570\u306a\u3063\u3066\u3044\u307e\u3059\u3002\u305d\u308c\u305e\u308c\u306e\u4ed5\u69d8\u3078\u306e\u30ea\u30f3\u30af\u3092\u4ee5\u4e0b\u306b\u793a\u3057\u307e\u3059\u3002"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"REST API",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://docs.aws.amazon.com/apigateway/latest/developerguide/set-up-lambda-proxy-integrations.html#api-gateway-simple-proxy-for-lambda-input-format"},"\u5165\u529b\u30d5\u30a9\u30fc\u30de\u30c3\u30c8")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://docs.aws.amazon.com/apigateway/latest/developerguide/set-up-lambda-proxy-integrations.html#api-gateway-simple-proxy-for-lambda-output-format"},"\u51fa\u529b\u30d5\u30a9\u30fc\u30de\u30c3\u30c8")))),(0,l.kt)("li",{parentName:"ul"},"HTTP API",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://docs.aws.amazon.com/apigateway/latest/developerguide/http-api-develop-integrations-lambda.html#http-api-develop-integrations-lambda.proxy-format"},"\u5165\u529b\u30d5\u30a9\u30fc\u30de\u30c3\u30c8 (2.0)")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://docs.aws.amazon.com/apigateway/latest/developerguide/http-api-develop-integrations-lambda.html#http-api-develop-integrations-lambda.v2"},"\u51fa\u529b\u30d5\u30a9\u30fc\u30de\u30c3\u30c8 (2.0)"))))),(0,l.kt)("h4",{id:"rack-\u306e\u5165\u51fa\u529b\u4ed5\u69d8\u3068\u306e\u76f8\u4e92\u5909\u63db"},"rack \u306e\u5165\u51fa\u529b\u4ed5\u69d8\u3068\u306e\u76f8\u4e92\u5909\u63db"),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"https://github.com/aws-samples/rails-lambda-handler"},"AWS Lambda handler sample for Ruby on Rails")," \u3067\u306f\u3001API Gateway \u306e\u7a2e\u985e\u306b\u5fdc\u3058\u3066 ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/rack/rack/blob/main/SPEC.rdoc"},"rack \u306e\u4ed5\u69d8"),"\u306b\u57fa\u3065\u3044\u305f\u5909\u63db\u51e6\u7406\u3092\u884c\u3046\u30cf\u30f3\u30c9\u30e9\u30fc\u95a2\u6570\u306e\u30b5\u30f3\u30d7\u30eb\u3092\u63d0\u4f9b\u3057\u3066\u3044\u307e\u3059\u3002"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://github.com/aws-samples/rails-lambda-handler/blob/main/rails/lambda_rest.rb"},"REST API \u5411\u3051\u30cf\u30f3\u30c9\u30e9\u30fc\u95a2\u6570 (lambda_rest.handler)")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://github.com/aws-samples/rails-lambda-handler/blob/main/rails/lambda_http.rb"},"HTTP API \u5411\u3051\u30cf\u30f3\u30c9\u30e9\u30fc\u95a2\u6570 (lambda_http.handler)"))),(0,l.kt)("p",null,"\u4e0a\u8a18\u306e\u30b3\u30fc\u30c9\u3092 Ruby on Rails \u30a2\u30d7\u30ea\u306e\u30eb\u30fc\u30c8\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u30b3\u30d4\u30fc\u3057\u3001Lambda \u95a2\u6570\u306e\u30cf\u30f3\u30c9\u30e9\u30fc\u95a2\u6570\u3068\u3057\u3066\u8a2d\u5b9a\u3059\u308c\u3070\u3001Ruby on Rails \u30a2\u30d7\u30ea\u3092 Lambda \u95a2\u6570\u3068\u3057\u3066\u5b9f\u884c\u3059\u308b\u4e8b\u304c\u3067\u304d\u307e\u3059\u3002"),(0,l.kt)("p",null,"\u30cf\u30f3\u30c9\u30e9\u30fc\u95a2\u6570\u304c\u884c\u3063\u3066\u3044\u308b\u5909\u63db\u51e6\u7406\u306e\u6982\u8981\u306f\u4ee5\u4e0b\u306e\u901a\u308a\u3067\u3059\u3002"),(0,l.kt)("h4",{id:"\u30ea\u30af\u30a8\u30b9\u30c8\u5bfe\u5fdc\u8868"},"\u30ea\u30af\u30a8\u30b9\u30c8\u5bfe\u5fdc\u8868"),(0,l.kt)("p",null,"REST API \u3068 HTTP API \u306e\u5165\u529b\u30d1\u30e9\u30e1\u30fc\u30bf\u30fc\u306f\u3001rack \u306e env \u5909\u6570\u306b\u5909\u63db\u3055\u308c\u307e\u3059\u3002"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"rack \u306e env \u5909\u6570\u540d"),(0,l.kt)("th",{parentName:"tr",align:null},"\u610f\u5473"),(0,l.kt)("th",{parentName:"tr",align:null},"REST API"),(0,l.kt)("th",{parentName:"tr",align:null},"HTTP API"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"REQUEST_METHOD")),(0,l.kt)("td",{parentName:"tr",align:null},"HTTP \u30e1\u30bd\u30c3\u30c9"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"httpMethod")),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"requestContext.http.method"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"SCRIPT_NAME")),(0,l.kt)("td",{parentName:"tr",align:null},"\u30d1\u30b9\u306e\u30eb\u30fc\u30c8"),(0,l.kt)("td",{parentName:"tr",align:null},"\u74b0\u5883\u5909\u6570 ",(0,l.kt)("inlineCode",{parentName:"td"},"RAILS_RELATIVE_URL_ROOT")," \u306e\u5024"),(0,l.kt)("td",{parentName:"tr",align:null},"\u74b0\u5883\u5909\u6570 ",(0,l.kt)("inlineCode",{parentName:"td"},"RAILS_RELATIVE_URL_ROOT")," \u306e\u5024")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"PATH_INFO")),(0,l.kt)("td",{parentName:"tr",align:null},"\u30d1\u30b9"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"path")),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"requestContext.http.path"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"QUERY_STRING")),(0,l.kt)("td",{parentName:"tr",align:null},"\u30af\u30a8\u30ea\u6587\u5b57\u5217"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"multiValueQueryStringParameters")," \u304b\u3089\u518d\u69cb\u7bc9"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"rawQueryString"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"SERVER_NAME")),(0,l.kt)("td",{parentName:"tr",align:null},"\u30c9\u30e1\u30a4\u30f3\u540d"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"headers.X-Forwarded-Host"),(0,l.kt)("br",null),"or ",(0,l.kt)("inlineCode",{parentName:"td"},"headers.Host")),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"headers.x-forwarded-host"),(0,l.kt)("br",null),"or ",(0,l.kt)("inlineCode",{parentName:"td"},"headers.host"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"SERVER_PORT")),(0,l.kt)("td",{parentName:"tr",align:null},"\u30dd\u30fc\u30c8"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"headers.X-Forwarded-Port")),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"headers.x-forwarded-port"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"SERVER_PROTOCOL")),(0,l.kt)("td",{parentName:"tr",align:null},"HTTP \u30d0\u30fc\u30b8\u30e7\u30f3"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"requestContext.protocol")),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"requestContext.http.protocol"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"rack.url_scheme")),(0,l.kt)("td",{parentName:"tr",align:null},"URL \u30b9\u30ad\u30fc\u30e0"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"headers.CloudFront-Forwarded-Proto"),(0,l.kt)("br",null),"or ",(0,l.kt)("inlineCode",{parentName:"td"},"headers.X-Forwarded-Proto")),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"headers.cloudfront-forwarded-proto"),(0,l.kt)("br",null),"or ",(0,l.kt)("inlineCode",{parentName:"td"},"headers.x-forwarded-proto"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"rack.input")),(0,l.kt)("td",{parentName:"tr",align:null},"HTTP \u30dc\u30c7\u30a3"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"body")),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"body"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"CONTENT_LENGTH")),(0,l.kt)("td",{parentName:"tr",align:null},"\u30dc\u30c7\u30a3\u306e\u30b5\u30a4\u30ba"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"body")," \u306e\u30b5\u30a4\u30ba\u304b\u3089\u8a08\u7b97"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"body")," \u306e\u30b5\u30a4\u30ba\u304b\u3089\u8a08\u7b97")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"HTTP_COOKIE")),(0,l.kt)("td",{parentName:"tr",align:null},"Cookie \u30c7\u30fc\u30bf"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"multiValueHeaders.Cookie")),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"cookies")," \u304b\u3089\u518d\u69cb\u7bc9")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"HTTP_*")),(0,l.kt)("td",{parentName:"tr",align:null},"\u305d\u306e\u4ed6\u306e\u30d8\u30c3\u30c0\u30fc"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"multiValueHeaders")),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"headers"))))),(0,l.kt)("h4",{id:"\u30ec\u30b9\u30dd\u30f3\u30b9\u5bfe\u5fdc\u8868"},"\u30ec\u30b9\u30dd\u30f3\u30b9\u5bfe\u5fdc\u8868"),(0,l.kt)("p",null,"rack \u306e\u30ec\u30b9\u30dd\u30f3\u30b9\u306f\u3001REST API \u3068 HTTP API \u306e\u51fa\u529b\u30d1\u30e9\u30e1\u30fc\u30bf\u30fc\u306b\u5909\u63db\u3055\u308c\u307e\u3059\u3002"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"\u30ec\u30b9\u30dd\u30f3\u30b9\u306e\u8981\u7d20"),(0,l.kt)("th",{parentName:"tr",align:null},"REST API"),(0,l.kt)("th",{parentName:"tr",align:null},"HTTP API"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"\u30b9\u30c6\u30fc\u30bf\u30b9\u30b3\u30fc\u30c9"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"statusCode")),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"statusCode"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"\u30dc\u30c7\u30a3"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"body")),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"body"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Cookie \u30c7\u30fc\u30bf"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"multiValueHeaders.Set-Cookie")),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"cookies"))),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"\u305d\u306e\u4ed6\u306e\u30d8\u30c3\u30c0\u30fc"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"headers"),(0,l.kt)("br",null),"or ",(0,l.kt)("inlineCode",{parentName:"td"},"multiValueHeaders")),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"headers"))))),(0,l.kt)("h3",{id:"\u30b5\u30f3\u30d7\u30eb\u3092-aws-\u3067\u52d5\u304b\u3057\u3066\u307f\u308b"},"\u30b5\u30f3\u30d7\u30eb\u3092 AWS \u3067\u52d5\u304b\u3057\u3066\u307f\u308b"),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"https://github.com/aws-samples/rails-lambda-handler"},"AWS Lambda handler sample for Ruby on Rails")," \u3067\u306f\u3001\u5192\u982d\u3067\u89e3\u8aac\u3057\u305f\u30b5\u30f3\u30d7\u30eb\u30a2\u30d7\u30ea\u3092 API Gateway + Lambda \u69cb\u6210\u3067\u30c7\u30d7\u30ed\u30a4\u3059\u308b ",(0,l.kt)("a",{parentName:"p",href:"https://aws.amazon.com/jp/getting-started/guides/setup-cdk/"},"AWS CDK")," \u306e\u30b5\u30f3\u30d7\u30eb\u3082\u63d0\u4f9b\u3057\u3066\u3044\u307e\u3059\u3002"),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"#%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AB-web-%E3%82%A2%E3%83%97%E3%83%AA%E3%81%AE%E5%8B%95%E4%BD%9C%E7%A2%BA%E8%AA%8D"},"\u30b5\u30f3\u30d7\u30eb Web \u30a2\u30d7\u30ea\u306e\u52d5\u4f5c\u78ba\u8a8d"),"\u3092\u884c\u3063\u305f\u5f8c\u3001",(0,l.kt)("a",{parentName:"p",href:"https://aws.amazon.com/jp/getting-started/guides/setup-cdk/module-two/"},"AWS CDK \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3068\u8a2d\u5b9a"),"\u3092\u884c\u3063\u305f\u4e0a\u3067\u3001",(0,l.kt)("inlineCode",{parentName:"p"},"cdk")," \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3067\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3059\u308b\u3068\u30c7\u30d7\u30ed\u30a4\u304c\u958b\u59cb\u3055\u308c\u307e\u3059\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"npm ci\nnpx cdk deploy -c railsMasterKey=d1c2ae419e40d2c43006aacdf98cf7f0\n")),(0,l.kt)("p",null,"\u30c7\u30d7\u30ed\u30a4\u304c\u7d42\u308f\u308b\u3068\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u51fa\u529b\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"RailsLambdaStack.HttpHttpApiUrlE6BB121E = https://xxxx.execute-api.ap-northeast-1.amazonaws.com/\nRailsLambdaStack.RestRestApiUrl2AB183B3 = https://yyyy.execute-api.ap-northeast-1.amazonaws.com/default/\n")),(0,l.kt)("p",null,"\u5f8c\u306f\u3001\u30ed\u30fc\u30ab\u30eb\u3067\u8d77\u52d5\u3057\u305f\u6642\u3068\u540c\u3058\u3088\u3046\u306b\u52d5\u4f5c\u78ba\u8a8d\u3057\u3066\u4e0b\u3055\u3044\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'curl https://xxxx.execute-api.ap-northeast-1.amazonaws.com/messages\n\n[{"id":1,"text":"Hello, World!","created_at":"2022-12-15T01:31:59.291Z","updated_at":"2022-12-15T01:31:59.291Z","url":"https://xxxx.execute-api.ap-northeast-1.amazonaws.com/messages/1"}]\n')),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'curl https://yyyy.execute-api.ap-northeast-1.amazonaws.com/default/messages\n\n[{"id":1,"text":"Hello, World!","created_at":"2022-12-15T01:31:59.291Z","updated_at":"2022-12-15T01:31:59.291Z","url":"https://yyyy.execute-api.ap-northeast-1.amazonaws.com/default/messages/1"}]\n')),(0,l.kt)("h2",{id:"\u307e\u3068\u3081"},"\u307e\u3068\u3081"),(0,l.kt)("p",null,"\u4eca\u56de\u306f\u3001",(0,l.kt)("a",{parentName:"p",href:"https://github.com/aws-samples/rails-lambda-handler"},"AWS Lambda handler sample for Ruby on Rails")," \u306e\u30b5\u30f3\u30d7\u30eb\u3092\u4e2d\u5fc3\u306b\u3001Amazon API Gateway + AWS Lambda \u74b0\u5883\u3067 Ruby on Rails \u306e Web \u30a2\u30d7\u30ea\u3092\u7a3c\u50cd\u3055\u305b\u308b\u306e\u306b\u5fc5\u8981\u306a\u6280\u8853\u7684\u8981\u7d20\u3092\u89e3\u8aac\u3057\u307e\u3057\u305f\u3002\u30e6\u30fc\u30b9\u30b1\u30fc\u30b9\u6b21\u7b2c\u3067\u306f\u9078\u629e\u80a2\u306b\u306a\u308a\u5f97\u308b\u3068\u601d\u3044\u307e\u3059\u306e\u3067\u3001\u3053\u306e\u3088\u3046\u306a\u4e8b\u304c\u53ef\u80fd\u3067\u3042\u308b\u4e8b\u3092\u899a\u3048\u3066\u304a\u3044\u3066\u9802\u3051\u308c\u3070\u3068\u601d\u3044\u307e\u3059\u3002"))}k.isMDXComponent=!0},8997:(t,a,e)=>{e.d(a,{Z:()=>n});const n=e.p+"assets/images/alb_architecture-8a888db1c6360af59b6423819e7eb53b.png"},6297:(t,a,e)=>{e.d(a,{Z:()=>n});const n=e.p+"assets/images/apigw_architecture-39a008e8a527577f918e0c9f3e7038e6.png"},7272:(t,a,e)=>{e.d(a,{Z:()=>n});const n=e.p+"assets/images/rails_lambda-5e0576527459d58d855b0873aaf4f7e6.png"},912:(t,a,e)=>{e.d(a,{Z:()=>n});const n=e.p+"assets/images/rails_puma-5ccb39d4d56bc628cee4ec8b58d1853f.png"}}]);